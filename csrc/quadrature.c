/*
 *  quadrature.c
 *  FEM
 *
 *  Guass rules are originally generated by Ludmil Zikatonov 
 *  Modified by Xuehai Huang on 10/21/08.
 *
 *  Copyright 2008 PSU. All rights reserved.
 *
 */

/*! \file quadrature.c
 *  \brief Quadrature rules
 */
 
#include <stdio.h>
#include <math.h>

/**
 * \fn int getNumQuadPoints(int dop, int dim)
 * \brief Get the number of quadrature points based on the dop degree of integrand
 * \param dop degree of integrand which is a polynomial
 * \param dim the dimension of space
 * \return the number of quadrature points
 */
int getNumQuadPoints(int dop, int dim)
{
	int num_qp=1; // the number of numerical intergation points

	if(dop<0)
		dop=0;
	
	if(dim==1)
	{		
		num_qp=(dop+2)/2;
		if(num_qp>20)
			num_qp=20;
	}

	if(dim==2)
	{		
		num_qp=pow((dop+2)/2,2);
		if(num_qp>49)
			num_qp=49;
	}

	return num_qp;
}

/**
 * \fn void init_quadrature(int num_qp, int ncoor, double (*gauss)[3])
 * \brief Initialize piece Lagrange quadrature points and weights
 * \param num_qp the number of quadrature points
 * \param ncoor the dimension of space
 * \param (*gauss)[3] gauss[*][0] -- quad point x in ref coor
 *					  gauss[*][1] -- quad point y in ref coor
 *					  gauss[*][2] -- quad weight
 */
void init_quadrature(int num_qp, int ncoor, double (*gauss)[3])
{
	if(num_qp<=0)
	{
		printf(" Number of quadrature points must be positive.\n");
		return;
	}
	
	if(ncoor!=2)
	{
		printf(" Only 2-d quadrature rule supported currently.\n");
		return;
	}
	
	switch (num_qp) {
		case 1:  // 1-point Gauss rule
			gauss[0][0] = 1.0/3;
			gauss[0][1] = 1.0/3;
			gauss[0][2] = 0.5000000000000000000000000;
			break;
		case 0:  // 3-point mid-point rule
			gauss[0][0] = 0.5000000000000000000000000;
			gauss[0][1] = 0.5000000000000000000000000;
			gauss[0][2] = 0.1666666666666666666666667;
			
			gauss[1][0] = 0.0000000000000000000000000;
			gauss[1][1] = 0.5000000000000000000000000;
			gauss[1][2] = 0.1666666666666666666666667;
			
			gauss[2][0] = 0.5000000000000000000000000;
			gauss[2][1] = 0.0000000000000000000000000;
			gauss[2][2] = 0.1666666666666666666666667;
			break;
		case 3:  // 3-point Lagrange rule
			gauss[0][0] = 1.0000000000000000000000000;
			gauss[0][1] = 0.0000000000000000000000000;
			gauss[0][2] = 0.1666666666666666666666667;
			
			gauss[1][0] = 0.0000000000000000000000000;
			gauss[1][1] = 1.0000000000000000000000000;
			gauss[1][2] = 0.1666666666666666666666667;
			
			gauss[2][0] = 0.0000000000000000000000000;
			gauss[2][1] = 0.0000000000000000000000000;
			gauss[2][2] = 0.1666666666666666666666667;
			break;
		case 6:  // 6-point Newton-Cotes rule
			gauss[0][0] = 1;
			gauss[0][1] = 0;
			gauss[0][2] = 1.0/24;
			
			gauss[1][0] = 0;
			gauss[1][1] = 1;
			gauss[1][2] = 1.0/24;
			
			gauss[2][0] = 0;
			gauss[2][1] = 0;
			gauss[2][2] = 1.0/24;
			
			gauss[3][0] = 0.5;
			gauss[3][1] = 0.5;
			gauss[3][2] = 0.125;
			
			gauss[4][0] = 0;
			gauss[4][1] = 0.5;
			gauss[4][2] = 0.125;
			
			gauss[5][0] = 0.5;
			gauss[5][1] = 0;
			gauss[5][2] = 0.125;
			break;
		case 7:  // 7-point Newton-Cotes rule
			gauss[0][0] = 1;
			gauss[0][1] = 0;
			gauss[0][2] = 1.0/18;
			
			gauss[1][0] = 0;
			gauss[1][1] = 1;
			gauss[1][2] = 1.0/18;
			
			gauss[2][0] = 0;
			gauss[2][1] = 0;
			gauss[2][2] = 1.0/18;
			
			gauss[3][0] = 0.5;
			gauss[3][1] = 0.5;
			gauss[3][2] = 1.0/18;
			
			gauss[4][0] = 0;
			gauss[4][1] = 0.5;
			gauss[4][2] = 1.0/18;
			
			gauss[5][0] = 0.5;
			gauss[5][1] = 0;
			gauss[5][2] = 1.0/18;
			
			gauss[6][0] = 1.0/3;
			gauss[6][1] = 1.0/3;
			gauss[6][2] = 1.0/6;
			break;
		case 15:  // 15-point Lagrange rule
			gauss[0][0] = 1;
			gauss[0][1] = 0;
			gauss[0][2] = 1.0/96;
			
			gauss[1][0] = 0;
			gauss[1][1] = 1;
			gauss[1][2] = 1.0/96;
			
			gauss[2][0] = 0;
			gauss[2][1] = 0;
			gauss[2][2] = 1.0/96;
			
			gauss[3][0] = 0.75;
			gauss[3][1] = 0.25;
			gauss[3][2] = 1.0/32;
			
			gauss[4][0] = 0.5;
			gauss[4][1] = 0.5;
			gauss[4][2] = 1.0/32;
			
			gauss[5][0] = 0.25;
			gauss[5][1] = 0.75;
			gauss[5][2] = 1.0/32;
			
			gauss[6][0] = 0;
			gauss[6][1] = 0.75;
			gauss[6][2] = 1.0/32;
			
			gauss[7][0] = 0;
			gauss[7][1] = 0.5;
			gauss[7][2] = 1.0/32;
			
			gauss[8][0] = 0;
			gauss[8][1] = 0.25;
			gauss[8][2] = 1.0/32;
			
			gauss[9][0] = 0.25;
			gauss[9][1] = 0;
			gauss[9][2] = 1.0/32;
			
			gauss[10][0] = 0.5;
			gauss[10][1] = 0;
			gauss[10][2] = 1.0/32;
			
			gauss[11][0] = 0.75;
			gauss[11][1] = 0;
			gauss[11][2] = 1.0/32;
			
			gauss[12][0] = 0.5;
			gauss[12][1] = 0.25;
			gauss[12][2] = 1.0/16;
			
			gauss[13][0] = 0.25;
			gauss[13][1] = 0.5;
			gauss[13][2] = 1.0/16;
			
			gauss[14][0] = 0.25;
			gauss[14][1] = 0.25;
			gauss[14][2] = 1.0/16;
			break;
		default:
			printf("%d-point Lagrange rule is not supported.\n",num_qp);
			break;
	}
	
	return;
}

/**
 * \fn void init_Gauss(int num_qp, int ncoor, double (*gauss)[3])
 * \brief Initialize Gauss quadrature points and weights
 * \param num_qp the number of quadrature points
 * \param ncoor the dimension of space
 * \param (*gauss)[3] gauss[*][0] -- quad point x in ref coor
 *					  gauss[*][1] -- quad point y in ref coor
 *					  gauss[*][2] -- quad weight
 */
void init_Gauss(int num_qp, int ncoor, double (*gauss)[3])
{
	if(num_qp<=0)
	{
		printf(" Number of quadrature points must be positive.\n");
		return;
	}
	
	if(ncoor!=2)
	{
		printf(" Only 2-d quadrature rule supported currently.\n");
		return;
	}
	
	switch (num_qp) {
		case 1:  // 1-point Gauss rule
			gauss[0][0] = 1.0/3;
			gauss[0][1] = 1.0/3;
			gauss[0][2] = 0.5000000000000000000000000;
			break;
		case 3:  // 3-point Gauss rule
			gauss[0][0] = 0.1666666666666666666666667;
			gauss[0][1] = 0.1666666666666666666666667;
			gauss[0][2] = 0.1666666666666666666666667;
			
			gauss[1][0] = 0.1666666666666666666666667;
			gauss[1][1] = 0.6666666666666666666666667;
			gauss[1][2] = 0.1666666666666666666666667;
			
			gauss[2][0] = 0.6666666666666666666666667;
			gauss[2][1] = 0.1666666666666666666666667;
			gauss[2][2] = 0.1666666666666666666666667;
			break;
		case 4:  // 4-point Gauss rule
			gauss[0][0] = 0.7503111022260811817747560e-01;
			gauss[0][1] = 0.6449489742783178098197284e+00;
			gauss[0][2] = 0.9097930912801141530281550e-01;
			
			gauss[1][0] = 0.2800199154990740720027960e+00;
			gauss[1][1] = 0.6449489742783178098197284e+00;
			gauss[1][2] = 0.9097930912801141530281550e-01;
			
			gauss[2][0] = 0.1785587282636164231170351e+00;
			gauss[2][1] = 0.1550510257216821901802716e+00;
			gauss[2][2] = 0.1590206908719885846971845e+00;
			
			gauss[3][0] = 0.6663902460147013867026933e+00;
			gauss[3][1] = 0.1550510257216821901802716e+00;
			gauss[3][2] = 0.1590206908719885846971845e+00;
			break;
		case 9:  // 9-point Gauss rule
			gauss[0][0] = 0.2393113228708061896738275e-01;
			gauss[0][1] = 0.7876594617608470560252419e+00;
			gauss[0][2] = 0.1939638330595947848163369e-01;
			
			gauss[1][0] = 0.1061702691195764719873791e+00;
			gauss[1][1] = 0.7876594617608470560252419e+00;
			gauss[1][2] = 0.3103421328953516557061390e-01;
			
			gauss[2][0] = 0.1884094059520723250073754e+00;
			gauss[2][1] = 0.7876594617608470560252419e+00;
			gauss[2][2] = 0.1939638330595947848163369e-01;
			
			gauss[3][0] = 0.6655406783916450412865057e-01;
			gauss[3][1] = 0.4094668644407347108649263e+00;
			gauss[3][2] = 0.6367808509988506852608905e-01;
			
			gauss[4][0] = 0.2952665677796326445675369e+00;
			gauss[4][1] = 0.4094668644407347108649263e+00;
			gauss[4][2] = 0.1018849361598161096417425e+00;
			
			gauss[5][0] = 0.5239790677201007850064232e+00;
			gauss[5][1] = 0.4094668644407347108649263e+00;
			gauss[5][2] = 0.6367808509988506852608905e-01;
			
			gauss[6][0] = 0.1027176548096262680160926e+00;
			gauss[6][1] = 0.8858795951270394739554614e-01;
			gauss[6][2] = 0.5581442048304434188116615e-01;
			
			gauss[7][0] = 0.4557060202436480263022269e+00;
			gauss[7][1] = 0.8858795951270394739554614e-01;
			gauss[7][2] = 0.8930307277287094700986584e-01;
			
			gauss[8][0] = 0.8086943856776697845883612e+00;
			gauss[8][1] = 0.8858795951270394739554614e-01;
			gauss[8][2] = 0.5581442048304434188116615e-01;
			break;
		case 16:  // 16-point Gauss rule
			gauss[0][0] = 0.9703785126946112175961724e-02;
			gauss[0][1] = 0.8602401356562194478479129e+00;
			gauss[0][2] = 0.5423225910525254453528332e-02;
			
			gauss[1][0] = 0.4612207990645204861943693e-01;
			gauss[1][1] = 0.8602401356562194478479129e+00;
			gauss[1][2] = 0.1016725956447878663340924e-01;
			
			gauss[2][0] = 0.9363778443732850353265015e-01;
			gauss[2][1] = 0.8602401356562194478479129e+00;
			gauss[2][2] = 0.1016725956447878663340924e-01;
			
			gauss[3][0] = 0.1300560792168344399761254e+00;
			gauss[3][1] = 0.8602401356562194478479129e+00;
			gauss[3][2] = 0.5423225910525254453528332e-02;
			
			gauss[4][0] = 0.2891208422438901271682135e-01;
			gauss[4][1] = 0.5835904323689168200566977e+00;
			gauss[4][2] = 0.2258404928236993135842135e-01;
			
			gauss[5][0] = 0.1374191041345743684268067e+00;
			gauss[5][1] = 0.5835904323689168200566977e+00;
			gauss[5][2] = 0.4233972452174628905480675e-01;
			
			gauss[6][0] = 0.2789904634965088115164956e+00;
			gauss[6][1] = 0.5835904323689168200566977e+00;
			gauss[6][2] = 0.4233972452174628905480675e-01;
			
			gauss[7][0] = 0.3874974834066941672264810e+00;
			gauss[7][1] = 0.5835904323689168200566977e+00;
			gauss[7][2] = 0.2258404928236993135842135e-01;
			
			gauss[8][0] = 0.5021012321136977210504381e-01;
			gauss[8][1] = 0.2768430136381238276800460e+00;
			gauss[8][2] = 0.3538806789808594616389450e-01;
			
			gauss[9][0] = 0.2386486597314429209541046e+00;
			gauss[9][1] = 0.2768430136381238276800460e+00;
			gauss[9][2] = 0.6634421610704973423180774e-01;
			
			gauss[10][0] = 0.4845083266304332513658494e+00;
			gauss[10][1] = 0.2768430136381238276800460e+00;
			gauss[10][2] = 0.6634421610704973423180774e-01;
			
			gauss[11][0] = 0.6729468631505064002149102e+00;
			gauss[11][1] = 0.2768430136381238276800460e+00;
			gauss[11][2] = 0.3538806789808594616389450e-01;
			
			gauss[12][0] = 0.6546699455501446386445480e-01;
			gauss[12][1] = 0.5710419611451768219312119e-01;
			gauss[12][2] = 0.2356836819338233236742181e-01;
			
			gauss[13][0] = 0.3111645522443570344411343e+00;
			gauss[13][1] = 0.5710419611451768219312119e-01;
			gauss[13][2] = 0.4418508852236172573671028e-01;
			
			gauss[14][0] = 0.6317312516411252833657445e+00;
			gauss[14][1] = 0.5710419611451768219312119e-01;
			gauss[14][2] = 0.4418508852236172573671028e-01;
			
			gauss[15][0] = 0.8774288093304678539424240e+00;
			gauss[15][1] = 0.5710419611451768219312119e-01;
			gauss[15][2] = 0.2356836819338233236742181e-01;
			break;
		case 0: // 16-point Gauss rule by Young-Ju
			gauss[0][0] = 5.710419640e-2;   
			gauss[0][1] = 6.546699187e-2;   
			gauss[0][2] = 2.356836864e-2;
			
			gauss[1][0] = 2.768430114e-1;
			gauss[1][1] = 5.021012132e-2;
			gauss[1][2] = 3.538806860e-2;
			
			gauss[2][0] = 5.835904479e-1;
			gauss[2][1] = 2.891208197e-2;
			gauss[2][2] = 2.258404870e-2;
			
			gauss[3][0] = 8.602401614e-1;
			gauss[3][1] = 9.703829427e-3;
			gauss[3][2] = 5.423225927e-3;
			
			gauss[4][0] = 5.710419640e-2;
			gauss[4][1] = 3.111645635e-1;
			gauss[4][2] = 4.418508789e-2;
			
			gauss[5][0] = 2.768430114e-1;
			gauss[5][1] = 2.386486692e-1;
			gauss[5][2] = 6.634421523e-2;
			
			gauss[6][0] = 5.835904479e-1;
			gauss[6][1] = 1.374191040e-1;
			gauss[6][2] = 4.233972202e-2;
			
			gauss[7][0] = 8.602401614e-1;
			gauss[7][1] = 4.612207309e-2;
			gauss[7][2] = 1.016725926e-2;
			
			gauss[8][0] = 5.710419640e-2;  
			gauss[8][1] = 6.317312682e-1;   
			gauss[8][2] = 4.418508789e-2;
			
			gauss[9][0] = 2.768430114e-1;
			gauss[9][1] = 4.845083410e-1;   
			gauss[9][2] = 6.634421523e-2;
			
			gauss[10][0] = 5.835904479e-1;
			gauss[10][1] = 2.789904605e-1;
			gauss[10][2] = 4.233972202e-2;
			
			gauss[11][0] = 8.602401614e-1;   
			gauss[11][1] = 9.363776966e-2;   
			gauss[11][2] = 1.016725926e-2;
			
			gauss[12][0] = 5.710419640e-2;   
			gauss[12][1] = 8.774288117e-1;   
			gauss[12][2] = 2.356836864e-2;
			
			gauss[13][0] = 2.768430114e-1;
			gauss[13][1] = 6.729468673e-1;   
			gauss[13][2] = 3.538806860e-2;
			
			gauss[14][0] = 5.835904479e-1;
			gauss[14][1] = 3.874974701e-1;
			gauss[14][2] = 2.258404870e-2;
			
			gauss[15][0] = 8.602401614e-1;  
			gauss[15][1] = 1.300560556e-1;
			gauss[15][2] = 5.423225927e-3;
			break;
		case 25:  // 25-point Gauss rule
			gauss[0][0] = 0.4622288465046428525209780e-02;
			gauss[0][1] = 0.9014649142011735738765011e+00;
			gauss[0][2] = 0.1865552166877838436183754e-02;
			
			gauss[1][0] = 0.2273848306376403459813202e-01;
			gauss[1][1] = 0.9014649142011735738765011e+00;
			gauss[1][2] = 0.3768701695327620376776386e-02;
			
			gauss[2][0] = 0.4926754289941321306174945e-01;
			gauss[2][1] = 0.9014649142011735738765011e+00;
			gauss[2][2] = 0.4479406797281358559372037e-02;
			
			gauss[3][0] = 0.7579660273506239152536687e-01;
			gauss[3][1] = 0.9014649142011735738765011e+00;
			gauss[3][2] = 0.3768701695327620376776386e-02;
			
			gauss[4][0] = 0.9391279733377999759828912e-01;
			gauss[4][1] = 0.9014649142011735738765011e+00;
			gauss[4][2] = 0.1865552166877838436183754e-02;
			
			gauss[5][0] = 0.1428579439557138533782080e-01;
			gauss[5][1] = 0.6954642733536360945146148e+00;
			gauss[5][2] = 0.8755499182163831736919008e-02;
			
			gauss[6][0] = 0.7027629200828172118339338e-01;
			gauss[6][1] = 0.6954642733536360945146148e+00;
			gauss[6][2] = 0.1768745211048346587741866e-01;
			
			gauss[7][0] = 0.1522678633231819527426926e+00;
			gauss[7][1] = 0.6954642733536360945146148e+00;
			gauss[7][2] = 0.2102296748732207512195789e-01;
			
			gauss[8][0] = 0.2342594346380821843019918e+00;
			gauss[8][1] = 0.6954642733536360945146148e+00;
			gauss[8][2] = 0.1768745211048346587741866e-01;
			
			gauss[9][0] = 0.2902499322507925201475644e+00;
			gauss[9][1] = 0.6954642733536360945146148e+00;
			gauss[9][2] = 0.8755499182163831736919008e-02;
			
			gauss[10][0] = 0.2636464494447091747928250e-01;
			gauss[10][1] = 0.4379748102473861440050125e+00;
			gauss[10][2] = 0.1734150643136570012831098e-01;
			
			gauss[11][0] = 0.1296959367822541214837999e+00;
			gauss[11][1] = 0.4379748102473861440050125e+00;
			gauss[11][2] = 0.3503250450337172031698701e-01;
			
			gauss[12][0] = 0.2810125948763069279974937e+00;
			gauss[12][1] = 0.4379748102473861440050125e+00;
			gauss[12][2] = 0.4163896521519496780744188e-01;
			
			gauss[13][0] = 0.4323292529703597345111876e+00;
			gauss[13][1] = 0.4379748102473861440050125e+00;
			gauss[13][2] = 0.3503250450337172031698701e-01;
			
			gauss[14][0] = 0.5356605448081429385157050e+00;
			gauss[14][1] = 0.4379748102473861440050125e+00;
			gauss[14][2]= 0.1734150643136570012831098e-01;
			
			gauss[15][0] = 0.3762125234511119174727219e-01;
			gauss[15][1] = 0.1980134178736081725357921e+00;
			gauss[15][2] = 0.1980408313204735378039807e-01;
			
			gauss[16][0] = 0.1850707102673894331855753e+00;
			gauss[16][1] = 0.1980134178736081725357921e+00;
			gauss[16][2] = 0.4000728738616042409551254e-01;
			
			gauss[17][0] = 0.4009932910631959137321039e+00;
			gauss[17][1] = 0.1980134178736081725357921e+00;
			gauss[17][2] = 0.4755189705795400973985440e-01;
			
			gauss[18][0] = 0.6169158718590023942786325e+00;
			gauss[18][1] = 0.1980134178736081725357921e+00;
			gauss[18][2] = 0.4000728738616042409551254e-01;
			
			gauss[19][0] = 0.7643653297812806357169357e+00;
			gauss[19][1] = 0.1980134178736081725357921e+00;
			gauss[19][2] = 0.1980408313204735378039807e-01;
			
			gauss[20][0] = 0.4504259356980372309546899e-01;
			gauss[20][1] = 0.3980985705146874234080669e-01;
			gauss[20][2] = 0.1146508035159254779675419e-01;
			
			gauss[21][0] = 0.2215786095523792017723069e+00;
			gauss[21][1] = 0.3980985705146874234080669e-01;
			gauss[21][2] = 0.2316122192949838634362829e-01;
			
			gauss[22][0] = 0.4800950714742656288295967e+00;
			gauss[22][1] = 0.3980985705146874234080669e-01;
			gauss[22][2] = 0.2752898566446981099359601e-01;
			
			gauss[23][0] = 0.7386115333961520558868864e+00;
			gauss[23][1] = 0.3980985705146874234080669e-01;
			gauss[23][2] = 0.2316122192949838634362829e-01;
			
			gauss[24][0] = 0.9151475493787275345637243e+00;
			gauss[24][1] = 0.3980985705146874234080669e-01;
			gauss[24][2] = 0.1146508035159254779675419e-01;
			break;
		case 36:  // 36-point Gauss rule
			gauss[0][0] = 0.2466697152670243054005080e-02;
			gauss[0][1] = 0.9269456713197411148518740e+00;
			gauss[0][2] = 0.7485425612363183140950521e-03;
			
			gauss[1][0] = 0.1237506041744003817266408e-01;
			gauss[1][1] = 0.9269456713197411148518740e+00;
			gauss[1][2] = 0.1576221754023588582963184e-02;
			
			gauss[2][0] = 0.2781108211536058069826929e-01;
			gauss[2][1] = 0.9269456713197411148518740e+00;
			gauss[2][2] = 0.2044386591544858980950415e-02;
			
			gauss[3][0] = 0.4524324656489830444985675e-01;
			gauss[3][1] = 0.9269456713197411148518740e+00;
			gauss[3][2] = 0.2044386591544858980950415e-02;
			
			gauss[4][0] = 0.6067926826281884697546196e-01;
			gauss[4][1] = 0.9269456713197411148518740e+00;
			gauss[4][2] = 0.1576221754023588582963184e-02;
			
			gauss[5][0] = 0.7058763152758864209412095e-01;
			gauss[5][1] = 0.9269456713197411148518740e+00;
			gauss[5][2] = 0.7485425612363183140950521e-03;
			
			gauss[6][0] = 0.7791874701286432033793818e-02;
			gauss[6][1] = 0.7692338620300545009168834e+00;
			gauss[6][2] = 0.3765298212691672929234314e-02;
			
			gauss[7][0] = 0.3909070073282424404541472e-01;
			gauss[7][1] = 0.7692338620300545009168834e+00;
			gauss[7][2] = 0.7928667333796484710025645e-02;
			
			gauss[8][0] = 0.8785045497599719116592015e-01;
			gauss[8][1] = 0.7692338620300545009168834e+00;
			gauss[8][2] = 0.1028361722876633011482835e-01;
			
			gauss[9][0] = 0.1429156829939483079171965e+00;
			gauss[9][1] = 0.7692338620300545009168834e+00;
			gauss[9][2] = 0.1028361722876633011482835e-01;
			
			gauss[10][0] = 0.1916754372371212550377019e+00;
			gauss[10][1] = 0.7692338620300545009168834e+00;
			gauss[10][2] = 0.7928667333796484710025645e-02;
			
			gauss[11][0] = 0.2229742632686590670493228e+00;
			gauss[11][1] = 0.7692338620300545009168834e+00;
			gauss[11][2] = 0.3765298212691672929234314e-02;
			
			gauss[12][0] = 0.1490156336667116035714823e-01;
			gauss[12][1] = 0.5586715187715501320813933e+00;
			gauss[12][2] = 0.8451535796943121648933723e-02;
			
			gauss[13][0] = 0.7475897346264909767772818e-01;
			gauss[13][1] = 0.5586715187715501320813933e+00;
			gauss[13][2] = 0.1779657599702627725499296e-01;
			
			gauss[14][0] = 0.1680095191211918575326299e+00;
			gauss[14][1] = 0.5586715187715501320813933e+00;
			gauss[14][2] = 0.2308246365135823315636558e-01;
		
			gauss[15][0] = 0.2733189621072580103859768e+00;
			gauss[15][1] = 0.5586715187715501320813933e+00;
			gauss[15][2] = 0.2308246365135823315636558e-01;
			
			gauss[16][0] = 0.3665695077658007702408785e+00;
			gauss[16][1] = 0.5586715187715501320813933e+00;
			gauss[16][2] = 0.1779657599702627725499296e-01;
			
			gauss[17][0] = 0.4264269178617787075614584e+00;
			gauss[17][1] = 0.5586715187715501320813933e+00;
			gauss[17][2] = 0.8451535796943121648933723e-02;
			
			gauss[18][0] = 0.2238687297803063445050099e-01;
			gauss[18][1] = 0.3369846902811542990970530e+00;
			gauss[18][2] = 0.1206060640426510907696060e-01;
			
			gauss[19][0] = 0.1123116817809536957220250e+00;
			gauss[19][1] = 0.3369846902811542990970530e+00;
			gauss[19][2] = 0.2539627158904765582035844e-01;
			
			gauss[20][0] = 0.2524035680765180133752919e+00;
			gauss[20][1] = 0.3369846902811542990970530e+00;
			gauss[20][2] = 0.3293939890078669916221938e-01;
			
			gauss[21][0] = 0.4106117416423276875276552e+00;
			gauss[21][1] = 0.3369846902811542990970530e+00;
			gauss[21][2] = 0.3293939890078669916221938e-01;
			
			gauss[22][0] = 0.5507036279378920051809220e+00;
			gauss[22][1] = 0.3369846902811542990970530e+00;
			gauss[22][2] = 0.2539627158904765582035844e-01;
			
			gauss[23][0] = 0.6406284367408150664524460e+00;
			gauss[23][1] = 0.3369846902811542990970530e+00;
			gauss[23][2] = 0.1206060640426510907696060e-01;
			
			gauss[24][0] = 0.2876533301255912843698113e-01;
			gauss[24][1] = 0.1480785996684842918499769e+00;
			gauss[24][2] = 0.1161087476699751443083611e-01;
			
			gauss[25][0] = 0.1443114869504166464557392e+00;
			gauss[25][1] = 0.1480785996684842918499769e+00;
			gauss[25][2] = 0.2444926225805781423674754e-01;
			
			gauss[26][0] = 0.3243183045887760364106504e+00;
			gauss[26][1] = 0.1480785996684842918499769e+00;
			gauss[26][2] = 0.3171111159070397975276155e-01;
			
			gauss[27][0] = 0.5276030957427396717393727e+00;
			gauss[27][1] = 0.1480785996684842918499769e+00;
			gauss[27][2] = 0.3171111159070397975276155e-01;
			
			gauss[28][0] = 0.7076099133810990616942839e+00;
			gauss[28][1] = 0.1480785996684842918499769e+00;
			gauss[28][2] = 0.2444926225805781423674754e-01;
			
			gauss[29][0] = 0.8231560673189565797130420e+00;
			gauss[29][1] = 0.1480785996684842918499769e+00;
			gauss[29][2] = 0.1161087476699751443083611e-01;
			
			gauss[30][0] = 0.3277536661445989520154516e-01;
			gauss[30][1] = 0.2931642715978489197205028e-01;
			gauss[30][2] = 0.6194265352658849860014235e-02;
			
			gauss[31][0] = 0.1644292415948274481657064e+00;
			gauss[31][1] = 0.2931642715978489197205028e-01;
			gauss[31][2] = 0.1304339433008283128737061e-01;
			
			gauss[32][0] = 0.3695299243723766991833510e+00;
			gauss[32][1] = 0.2931642715978489197205028e-01;
			gauss[32][2] = 0.1691750568001266068034231e-01;
			
			gauss[33][0] = 0.6011536484678384088445987e+00;
			gauss[33][1] = 0.2931642715978489197205028e-01;
			gauss[33][2] = 0.1691750568001266068034231e-01;
			
			gauss[34][0] = 0.8062543312453876598622433e+00;
			gauss[34][1] = 0.2931642715978489197205028e-01;
			gauss[34][2] = 0.1304339433008283128737061e-01;
			
			gauss[35][0] = 0.9379082062257552128264046e+00;
			gauss[35][1] = 0.2931642715978489197205028e-01;
			gauss[35][2] = 0.6194265352658849860014235e-02;
			break;
		case 49:  // 49-point Gauss rule
			gauss[0][0] = 0.1431659581332948445688999e-02;
			gauss[0][1] = 0.9437374394630778535343478e+00;
			gauss[0][2] = 0.3375907567113747844459523e-03;
			
			gauss[1][0] = 0.7271058658560282492949164e-02;
			gauss[1][1] = 0.9437374394630778535343478e+00;
			gauss[1][2] = 0.7292426106515660112115446e-03;
			
			gauss[2][0] = 0.1671433656946750295425480e-01;
			gauss[2][1] = 0.9437374394630778535343478e+00;
			gauss[2][2] = 0.9955000916249671892041120e-03;
			
			gauss[3][0] = 0.2813128026846107323282610e-01;
			gauss[3][1] = 0.9437374394630778535343478e+00;
			gauss[3][2] = 0.1089695284831588119968157e-02;
			
			gauss[4][0] = 0.3954822396745464351139739e-01;
			gauss[4][1] = 0.9437374394630778535343478e+00;
			gauss[4][2] = 0.9955000916249671892041120e-03;
			
			gauss[5][0] = 0.4899150187836186397270303e-01;
			gauss[5][1] = 0.9437374394630778535343478e+00;
			gauss[5][2] = 0.7292426106515660112115446e-03;
			
			gauss[6][0] = 0.5483090095558919801996319e-01;
			gauss[6][1] = 0.9437374394630778535343478e+00;
			gauss[6][2] = 0.3375907567113747844459523e-03;
			
			gauss[7][0] = 0.4586412541637882763079511e-02;
			gauss[7][1] = 0.8197593082631076350124201e+00;
			gauss[7][2] = 0.1774485071438049608442658e-02;
			
			gauss[8][0] = 0.2329329894998979644828858e-01;
			gauss[8][1] = 0.8197593082631076350124201e+00;
			gauss[8][2] = 0.3833132573484684075609282e-02;
			
			gauss[9][0] = 0.5354544045728325221282914e-01;
			gauss[9][1] = 0.8197593082631076350124201e+00;
			gauss[9][2] = 0.5232667115687632726379401e-02;
			
			gauss[10][0] = 0.9012034586844618249378997e-01;
			gauss[10][1] = 0.8197593082631076350124201e+00;
			gauss[10][2] = 0.5727787200652742623468366e-02;
			
			gauss[11][0] = 0.1266952512796091127747508e+00;
			gauss[11][1] = 0.8197593082631076350124201e+00;
			gauss[11][2] = 0.5232667115687632726379401e-02;
			
			gauss[12][0] = 0.1569473927869025685392914e+00;
			gauss[12][1] = 0.8197593082631076350124201e+00;
			gauss[12][2] = 0.3833132573484684075609282e-02;
			
			gauss[13][0] = 0.1756542791952544822245004e+00;
			gauss[13][1] = 0.8197593082631076350124201e+00;
			gauss[13][2] = 0.1774485071438049608442658e-02;
			
			gauss[14][0] = 0.8972904006716703697492974e-02;
			gauss[14][1] = 0.6473752828868303626260922e+00;
			gauss[14][2] = 0.4297910087982423247056434e-02;
			
			gauss[15][0] = 0.4557124628029494113490578e-01;
			gauss[15][1] = 0.6473752828868303626260922e+00;
			gauss[15][2] = 0.9284078756888546352613518e-02;
			
			gauss[16][0] = 0.1047568427084817262927626e+00;
			gauss[16][1] = 0.6473752828868303626260922e+00;
			gauss[16][2] = 0.1267383600209279954896470e-01;
			
			gauss[17][0] = 0.1763123585565848186869539e+00;
			gauss[17][1] = 0.6473752828868303626260922e+00;
			gauss[17][2] = 0.1387304677156393168637868e-01;
			
			gauss[18][0] = 0.2478678744046879110811452e+00;
			gauss[18][1] = 0.6473752828868303626260922e+00;
			gauss[18][2] = 0.1267383600209279954896470e-01;
			
			gauss[19][0] = 0.3070534708328746962390020e+00;
			gauss[19][1] = 0.6473752828868303626260922e+00;
			gauss[19][2] = 0.9284078756888546352613518e-02;
			
			gauss[20][0] = 0.3436518131064529336764148e+00;
			gauss[20][1] = 0.6473752828868303626260922e+00;
			gauss[20][2] = 0.4297910087982423247056434e-02;
			
			gauss[21][0] = 0.1392289515659608599518407e-01;
			gauss[21][1] = 0.4528463736694446169985514e+00;
			gauss[21][2] = 0.6935542753734072742362389e-02;
			
			gauss[22][0] = 0.7071107454632530338118497e-01;
			gauss[22][1] = 0.4528463736694446169985514e+00;
			gauss[22][2] = 0.1498172921938941357190799e-01;
			
			gauss[23][0] = 0.1625469900128696646167676e+00;
			gauss[23][1] = 0.4528463736694446169985514e+00;
			gauss[23][2] = 0.2045178462250981418417614e-01;
			
			gauss[24][0] = 0.2735768131652776915007243e+00;
			gauss[24][1] = 0.4528463736694446169985514e+00;
			gauss[24][2] = 0.2238695250460706899401921e-01;
			
			gauss[25][0] = 0.3846066363176857183846809e+00;
			gauss[25][1] = 0.4528463736694446169985514e+00;
			gauss[25][2] = 0.2045178462250981418417614e-01;
			
			gauss[26][0] = 0.4764425517842300796202636e+00;
			gauss[26][1] = 0.4528463736694446169985514e+00;
			gauss[26][2] = 0.1498172921938941357190799e-01;
			
			gauss[27][0] = 0.5332307311739592970062645e+00;
			gauss[27][1] = 0.4528463736694446169985514e+00;
			gauss[27][2] = 0.6935542753734072742362389e-02;
			
			gauss[28][0] = 0.1868274434884273534596982e-01;
			gauss[28][1] = 0.2657898227845894684767894e+00;
			gauss[28][2] = 0.8247603013529574038759331e-02;
			
			gauss[29][0] = 0.9488521701286283095347225e-01;
			gauss[29][1] = 0.2657898227845894684767894e+00;
			gauss[29][2] = 0.1781596040067579543578056e-01;
			
			gauss[30][0] = 0.2181172683502983220175448e+00;
			gauss[30][1] = 0.2657898227845894684767894e+00;
			gauss[30][2] = 0.2432083637489711574352285e-01;
			
			gauss[31][0] = 0.3671050886077052657616053e+00;
			gauss[31][1] = 0.2657898227845894684767894e+00;
			gauss[31][2] = 0.2662209772138335648260900e-01;
			
			gauss[32][0] = 0.5160929088651122095056658e+00;
			gauss[32][1] = 0.2657898227845894684767894e+00;
			gauss[32][2] = 0.2432083637489711574352285e-01;
			
			gauss[33][0] = 0.6393249602025477005697384e+00;
			gauss[33][1] = 0.2657898227845894684767894e+00;
			gauss[33][2] = 0.1781596040067579543578056e-01;
			
			gauss[34][0] = 0.7155274328665677961772408e+00;
			gauss[34][1] = 0.2657898227845894684767894e+00;
			gauss[34][2] = 0.8247603013529574038759331e-02;
			
			gauss[35][0] = 0.2252791561566364109969225e-01;
			gauss[35][1] = 0.1146790531609042319096402e+00;
			gauss[35][2] = 0.7154643779096141969509067e-02;
			
			gauss[36][0] = 0.1144139277467613129097319e+00;
			gauss[36][1] = 0.1146790531609042319096402e+00;
			gauss[36][2] = 0.1545501766273406746103162e-01;
			
			gauss[37][0] = 0.2630088665758011781230588e+00;
			gauss[37][1] = 0.1146790531609042319096402e+00;
			gauss[37][2] = 0.2109787781815243944540462e-01;
			
			gauss[38][0] = 0.4426604734195478840451799e+00;
			gauss[38][1] = 0.1146790531609042319096402e+00;
			gauss[38][2] = 0.2309417967090930466923013e-01;
			
			gauss[39][0] = 0.6223120802632945899673009e+00;
			gauss[39][1] = 0.1146790531609042319096402e+00;
			gauss[39][2] = 0.2109787781815243944540462e-01;
			
			gauss[40][0] = 0.7709070190923344551806278e+00;
			gauss[40][1] = 0.1146790531609042319096402e+00;
			gauss[40][2] = 0.1545501766273406746103162e-01;
			
			gauss[41][0] = 0.8627930312234321269906675e+00;
			gauss[41][1] = 0.1146790531609042319096402e+00;
			gauss[41][2] = 0.7154643779096141969509067e-02;
			
			gauss[42][0] = 0.2487403237606075687067163e-01;
			gauss[42][1] = 0.2247938643871249810882550e-01;
			gauss[42][2] = 0.3623466079725786927077026e-02;
			
			gauss[43][0] = 0.1263292970196692449335864e+00;
			gauss[43][1] = 0.2247938643871249810882550e-01;      
			gauss[43][2] = 0.7827186648495094067212433e-02;
			
			gauss[44][0] = 0.2903993060879903088904502e+00;
			gauss[44][1] = 0.2247938643871249810882550e-01;      
			gauss[44][2] = 0.1068501060131496739994062e-01;
			
			gauss[45][0] = 0.4887603067806437509455873e+00;
			gauss[45][1] = 0.2247938643871249810882550e-01;     
			gauss[45][2] = 0.1169603676441935436310196e-01;
			
			gauss[46][0] = 0.6871213074732971930007243e+00;
			gauss[46][1] = 0.2247938643871249810882550e-01;
			gauss[46][2] = 0.1068501060131496739994062e-01;
			
			gauss[47][0] = 0.8511913165416182569575881e+00;
			gauss[47][1] = 0.2247938643871249810882550e-01;
			gauss[47][2] = 0.7827186648495094067212433e-02;
			
			gauss[48][0] = 0.9526465811852267450205029e+00;
			gauss[48][1] = 0.2247938643871249810882550e-01;
			gauss[48][2] = 0.3623466079725786927077026e-02;
			break;
		default:
			printf("%d-point Lagrange rule is not supported.\n",num_qp);
			break;
	}
	
	return;
}


/**
 * \fn void init_Gauss1D(int num_qp, int ncoor, double (*gauss)[2])
 * \brief Initialize Gauss quadrature points and weights, the algebraic precision is 2*num_qp-1
 * \param num_qp the number of quadrature points
 * \param ncoor the dimension of space
 * \param (*gauss)[2] gauss[*][0] -- quad point x in ref coor
 *					  gauss[*][1] -- quad weight
 */
void init_Gauss1D(int num_qp, int ncoor, double (*gauss)[2])
{
	if(num_qp<=0)
	{
		printf(" Number of quadrature points must be positive.\n");
		return;
	}
	
	if(ncoor!=1)
	{
		printf(" Only 1-d quadrature rule supported currently.\n");
		return;
	}
	
	switch (num_qp) {
		case 1:  // 1-point Gauss rule
			gauss[0][0] = 0.5; gauss[0][1] = 1;
			break;
		case 2:  // 2-point Gauss rule
			gauss[0][0] = 0.788675134594813; gauss[0][1] = 0.5;
			gauss[1][0] = 0.211324865405187; gauss[1][1] = 0.5;
			break;
		case 3:  // 3-point Gauss rule
			gauss[0][0] = 0.887298334620742; gauss[0][1] = 0.277777777777777;
			gauss[1][0] = 0.5; gauss[1][1] = 0.444444444444444;
			gauss[2][0] = 0.112701665379258; gauss[2][1] = 0.277777777777777;
			break;
		case 4:  // 4-point Gauss rule
			gauss[0][0] = 0.930568155797026; gauss[0][1] = 0.173927422568727;
			gauss[1][0] = 0.669990521792428; gauss[1][1] = 0.326072577431273;
			gauss[2][0] = 0.330009478207572; gauss[2][1] = 0.326072577431273;
			gauss[3][0] = 0.0694318442029737; gauss[3][1] = 0.173927422568727;
			break;
		case 5:  // 5-point Gauss rule
			gauss[0][0] = 0.953089922969332; gauss[0][1] = 0.118463442528095;
			gauss[1][0] = 0.769234655052841; gauss[1][1] = 0.239314335249683;
			gauss[2][0] = 0.5; gauss[2][1] = 0.284444444444444;
			gauss[3][0] = 0.230765344947158; gauss[3][1] = 0.239314335249683;
			gauss[4][0] = 0.046910077030668; gauss[4][1] = 0.118463442528095;
			break;
		case 6:  // 6-point Gauss rule
			gauss[0][0] = 0.966234757101576; gauss[0][1] = 0.0856622461895852;
			gauss[1][0] = 0.830604693233132; gauss[1][1] = 0.180380786524069;
			gauss[2][0] = 0.619309593041598; gauss[2][1] = 0.233956967286345;
			gauss[3][0] = 0.380690406958402; gauss[3][1] = 0.233956967286345;
			gauss[4][0] = 0.169395306766868; gauss[4][1] = 0.180380786524069;
			gauss[5][0] = 0.033765242898424; gauss[5][1] = 0.0856622461895852;
			break;
		case 7:  // 7-point Gauss rule
			gauss[0][0] = 0.974553956171379; gauss[0][1] = 0.0647424830844348;
			gauss[1][0] = 0.870765592799697; gauss[1][1] = 0.139852695744638;
			gauss[2][0] = 0.702922575688699; gauss[2][1] = 0.19091502525256;
			gauss[3][0] = 0.5; gauss[3][1] = 0.208979591836735;
			gauss[4][0] = 0.297077424311301; gauss[4][1] = 0.19091502525256;
			gauss[5][0] = 0.129234407200303; gauss[5][1] = 0.139852695744638;
			gauss[6][0] = 0.0254460438286208; gauss[6][1] = 0.0647424830844348;
			break;
		case 8:  // 8-point Gauss rule
			gauss[0][0] = 0.980144928248768; gauss[0][1] = 0.0506142681451884;
			gauss[1][0] = 0.898333238706813; gauss[1][1] = 0.111190517226687;
			gauss[2][0] = 0.762766204958164; gauss[2][1] = 0.156853322938944;
			gauss[3][0] = 0.591717321247825; gauss[3][1] = 0.181341891689181;
			gauss[4][0] = 0.408282678752175; gauss[4][1] = 0.181341891689181;
			gauss[5][0] = 0.237233795041836; gauss[5][1] = 0.156853322938944;
			gauss[6][0] = 0.101666761293187; gauss[6][1] = 0.111190517226687;
			gauss[7][0] = 0.0198550717512319; gauss[7][1] = 0.0506142681451884;
			break;
		case 9:  // 9-point Gauss rule
			gauss[0][0] = 0.984080119753813; gauss[0][1] = 0.0406371941807873;
			gauss[1][0] = 0.918015553663318; gauss[1][1] = 0.0903240803474287;
			gauss[2][0] = 0.806685716350295; gauss[2][1] = 0.130305348201468;
			gauss[3][0] = 0.662126711701905; gauss[3][1] = 0.156173538520001;
			gauss[4][0] = 0.5; gauss[4][1] = 0.16511967750063;
			gauss[5][0] = 0.337873288298096; gauss[5][1] = 0.156173538520001;
			gauss[6][0] = 0.193314283649705; gauss[6][1] = 0.130305348201468;
			gauss[7][0] = 0.0819844463366821; gauss[7][1] = 0.0903240803474287;
			gauss[8][0] = 0.015919880246187; gauss[8][1] = 0.0406371941807873;
			break;
		case 10:  // 10-point Gauss rule
			gauss[0][0] = 0.986953264258586; gauss[0][1] = 0.033335672154344;
			gauss[1][0] = 0.932531683344492; gauss[1][1] = 0.0747256745752903;
			gauss[2][0] = 0.839704784149512; gauss[2][1] = 0.109543181257991;
			gauss[3][0] = 0.716697697064624; gauss[3][1] = 0.134633359654998;
			gauss[4][0] = 0.574437169490816; gauss[4][1] = 0.147762112357376;
			gauss[5][0] = 0.425562830509184; gauss[5][1] = 0.147762112357376;
			gauss[6][0] = 0.283302302935376; gauss[6][1] = 0.134633359654998;
			gauss[7][0] = 0.160295215850488; gauss[7][1] = 0.109543181257991;
			gauss[8][0] = 0.0674683166555077; gauss[8][1] = 0.0747256745752903;
			gauss[9][0] = 0.0130467357414141; gauss[9][1] = 0.033335672154344;
			break;
		case 11:  // 11-point Gauss rule
			gauss[0][0] = 0.989114329073028; gauss[0][1] = 0.0278342835580868;
			gauss[1][0] = 0.943531299884048; gauss[1][1] = 0.062790184732452;
			gauss[2][0] = 0.865076002787025; gauss[2][1] = 0.093145105463867;
			gauss[3][0] = 0.759548064603406; gauss[3][1] = 0.116596882295995;
			gauss[4][0] = 0.634771577976172; gauss[4][1] = 0.131402272255123;
			gauss[5][0] = 0.5; gauss[5][1] = 0.13646254338895;
			gauss[6][0] = 0.365228422023828; gauss[6][1] = 0.131402272255123;
			gauss[7][0] = 0.240451935396594; gauss[7][1] = 0.116596882295995;
			gauss[8][0] = 0.134923997212975; gauss[8][1] = 0.093145105463867;
			gauss[9][0] = 0.0564687001159523; gauss[9][1] = 0.062790184732452;
			gauss[10][0] = 0.0108856709269715; gauss[10][1] = 0.0278342835580868;
			break;
		case 12:  // 12-point Gauss rule
			gauss[0][0] = 0.99078031712336; gauss[0][1] = 0.0235876681932559;
			gauss[1][0] = 0.952058628185237; gauss[1][1] = 0.0534696629976591;
			gauss[2][0] = 0.884951337097152; gauss[2][1] = 0.080039164271673;
			gauss[3][0] = 0.793658977143309; gauss[3][1] = 0.101583713361533;
			gauss[4][0] = 0.68391574949909; gauss[4][1] = 0.116746268269177;
			gauss[5][0] = 0.562616704255734; gauss[5][1] = 0.124573522906701;
			gauss[6][0] = 0.437383295744266; gauss[6][1] = 0.124573522906701;
			gauss[7][0] = 0.31608425050091; gauss[7][1] = 0.116746268269177;
			gauss[8][0] = 0.206341022856691; gauss[8][1] = 0.101583713361533;
			gauss[9][0] = 0.115048662902848; gauss[9][1] = 0.080039164271673;
			gauss[10][0] = 0.0479413718147626; gauss[10][1] = 0.0534696629976591;
			gauss[11][0] = 0.00921968287664038; gauss[11][1] = 0.0235876681932559;
			break;
		case 13:  // 13-point Gauss rule
			gauss[0][0] = 0.992091527359294; gauss[0][1] = 0.0202420023826579;
			gauss[1][0] = 0.958799199611489; gauss[1][1] = 0.0460607499188642;
			gauss[2][0] = 0.900789045366655; gauss[2][1] = 0.0694367551098936;
			gauss[3][0] = 0.82117466972017; gauss[3][1] = 0.0890729903809728;
			gauss[4][0] = 0.724246375518223; gauss[4][1] = 0.103908023768444;
			gauss[5][0] = 0.615229157977567; gauss[5][1] = 0.113141590131449;
			gauss[6][0] = 0.5; gauss[6][1] = 0.116275776615437;
			gauss[7][0] = 0.384770842022433; gauss[7][1] = 0.113141590131449;
			gauss[8][0] = 0.275753624481777; gauss[8][1] = 0.103908023768444;
			gauss[9][0] = 0.17882533027983; gauss[9][1] = 0.0890729903809728;
			gauss[10][0] = 0.0992109546333451; gauss[10][1] = 0.0694367551098936;
			gauss[11][0] = 0.041200800388511; gauss[11][1] = 0.0460607499188642;
			gauss[12][0] = 0.00790847264070593; gauss[12][1] = 0.0202420023826579;
			break;
		case 14:  // 14-point Gauss rule
			gauss[0][0] = 0.993141904348406; gauss[0][1] = 0.017559730165876;
			gauss[1][0] = 0.964217441831787; gauss[1][1] = 0.04007904357988;
			gauss[2][0] = 0.913600657534883; gauss[2][1] = 0.0607592853439516;
			gauss[3][0] = 0.843646452405843; gauss[3][1] = 0.0786015835790968;
			gauss[4][0] = 0.757624318179077; gauss[4][1] = 0.0927691987389689;
			gauss[5][0] = 0.659556184463945; gauss[5][1] = 0.102599231860648;
			gauss[6][0] = 0.554027474353672; gauss[6][1] = 0.107631926731579;
			gauss[7][0] = 0.445972525646328; gauss[7][1] = 0.107631926731579;
			gauss[8][0] = 0.340443815536055; gauss[8][1] = 0.102599231860648;
			gauss[9][0] = 0.242375681820923; gauss[9][1] = 0.0927691987389689;
			gauss[10][0] = 0.156353547594157; gauss[10][1] = 0.0786015835790968;
			gauss[11][0] = 0.0863993424651175; gauss[11][1] = 0.0607592853439516;
			gauss[12][0] = 0.0357825581682132; gauss[12][1] = 0.04007904357988;
			gauss[13][0] = 0.00685809565159384; gauss[13][1] = 0.017559730165876;
			break;
		case 15:  // 15-point Gauss rule
			gauss[0][0] = 0.993996259010243; gauss[0][1] = 0.0153766209980583;
			gauss[1][0] = 0.968636696200353; gauss[1][1] = 0.0351830237440541;
			gauss[2][0] = 0.924103291705214; gauss[2][1] = 0.0535796102335859;
			gauss[3][0] = 0.862208865680085; gauss[3][1] = 0.0697853389630771;
			gauss[4][0] = 0.785486086304269; gauss[4][1] = 0.083134602908497;
			gauss[5][0] = 0.697075673538782; gauss[5][1] = 0.093080500007781;
			gauss[6][0] = 0.600597046998717; gauss[6][1] = 0.0992157426635558;
			gauss[7][0] = 0.5; gauss[7][1] = 0.101289120962781;
			gauss[8][0] = 0.399402953001283; gauss[8][1] = 0.0992157426635558;
			gauss[9][0] = 0.302924326461218; gauss[9][1] = 0.093080500007781;
			gauss[10][0] = 0.214513913695731; gauss[10][1] = 0.083134602908497;
			gauss[11][0] = 0.137791134319915; gauss[11][1] = 0.0697853389630771;
			gauss[12][0] = 0.0758967082947864; gauss[12][1] = 0.0535796102335859;
			gauss[13][0] = 0.031363303799647; gauss[13][1] = 0.0351830237440541;
			gauss[14][0] = 0.00600374098975731; gauss[14][1] = 0.0153766209980583;
			break;
		case 16:  // 16-point Gauss rule
			gauss[0][0] = 0.994700467495825; gauss[0][1] = 0.013576229705877;
			gauss[1][0] = 0.972287511536616; gauss[1][1] = 0.0311267619693239;
			gauss[2][0] = 0.932815601193916; gauss[2][1] = 0.0475792558412464;
			gauss[3][0] = 0.877702204177502; gauss[3][1] = 0.062314485627767;
			gauss[4][0] = 0.808938122201322; gauss[4][1] = 0.0747979944082884;
			gauss[5][0] = 0.729008388828614; gauss[5][1] = 0.0845782596975013;
			gauss[6][0] = 0.640801775389629; gauss[6][1] = 0.0913017075224618;
			gauss[7][0] = 0.547506254918819; gauss[7][1] = 0.0947253052275342;
			gauss[8][0] = 0.452493745081181; gauss[8][1] = 0.0947253052275342;
			gauss[9][0] = 0.359198224610371; gauss[9][1] = 0.0913017075224618;
			gauss[10][0] = 0.270991611171386; gauss[10][1] = 0.0845782596975013;
			gauss[11][0] = 0.191061877798678; gauss[11][1] = 0.0747979944082884;
			gauss[12][0] = 0.122297795822499; gauss[12][1] = 0.062314485627767;
			gauss[13][0] = 0.0671843988060841; gauss[13][1] = 0.0475792558412464;
			gauss[14][0] = 0.0277124884633837; gauss[14][1] = 0.0311267619693239;
			gauss[15][0] = 0.00529953250417503; gauss[15][1] = 0.013576229705877;
			break;
		case 17:  // 17-point Gauss rule
			gauss[0][0] = 0.995287737657209; gauss[0][1] = 0.012074151434274;
			gauss[1][0] = 0.975337760884384; gauss[1][1] = 0.0277297646869936;
			gauss[2][0] = 0.940119576863493; gauss[2][1] = 0.0425180741585896;
			gauss[3][0] = 0.890757001948401; gauss[3][1] = 0.0559419235967019;
			gauss[4][0] = 0.828835579608345; gauss[4][1] = 0.0675681842342627;
			gauss[5][0] = 0.756345268543238; gauss[5][1] = 0.0770228805384052;
			gauss[6][0] = 0.675615881726938; gauss[6][1] = 0.0840020510782249;
			gauss[7][0] = 0.589242090747924; gauss[7][1] = 0.0882813526834963;
			gauss[8][0] = 0.5; gauss[8][1] = 0.0897232351781033;
			gauss[9][0] = 0.410757909252076; gauss[9][1] = 0.0882813526834963;
			gauss[10][0] = 0.324384118273062; gauss[10][1] = 0.0840020510782249;
			gauss[11][0] = 0.243654731456762; gauss[11][1] = 0.0770228805384052;
			gauss[12][0] = 0.171164420391655; gauss[12][1] = 0.0675681842342627;
			gauss[13][0] = 0.109242998051599; gauss[13][1] = 0.0559419235967019;
			gauss[14][0] = 0.059880423136507; gauss[14][1] = 0.0425180741585896;
			gauss[15][0] = 0.0246622391156161; gauss[15][1] = 0.0277297646869936;
			gauss[16][0] = 0.00471226234279132; gauss[16][1] = 0.012074151434274;
			break;
		case 18:  // 18-point Gauss rule
			gauss[0][0] = 0.995782584210466; gauss[0][1] = 0.0108080067632417;
			gauss[1][0] = 0.977911974785699; gauss[1][1] = 0.0248572744474846;
			gauss[2][0] = 0.946301233248778; gauss[2][1] = 0.0382128651274444;
			gauss[3][0] = 0.901852479486262; gauss[3][1] = 0.0504710220531435;
			gauss[4][0] = 0.845843521530177; gauss[4][1] = 0.0612776033557392;
			gauss[5][0] = 0.779885415536974; gauss[5][1] = 0.0703214573353253;
			gauss[6][0] = 0.705875580731421; gauss[6][1] = 0.0773423375631327;
			gauss[7][0] = 0.625943112845753; gauss[7][1] = 0.0821382418729164;
			gauss[8][0] = 0.542387506520868; gauss[8][1] = 0.0845711914815718;
			gauss[9][0] = 0.457612493479132; gauss[9][1] = 0.0845711914815718;
			gauss[10][0] = 0.374056887154247; gauss[10][1] = 0.0821382418729164;
			gauss[11][0] = 0.294124419268579; gauss[11][1] = 0.0773423375631327;
			gauss[12][0] = 0.220114584463026; gauss[12][1] = 0.0703214573353253;
			gauss[13][0] = 0.154156478469823; gauss[13][1] = 0.0612776033557392;
			gauss[14][0] = 0.0981475205137384; gauss[14][1] = 0.0504710220531435;
			gauss[15][0] = 0.0536987667512221; gauss[15][1] = 0.0382128651274444;
			gauss[16][0] = 0.0220880252143011; gauss[16][1] = 0.0248572744474846;
			gauss[17][0] = 0.00421741578953455; gauss[17][1] = 0.0108080067632417;
			break;
		case 19:  // 19-point Gauss rule
			gauss[0][0] = 0.996203421921792; gauss[0][1] = 0.00973089411486321;
			gauss[1][0] = 0.980104076067415; gauss[1][1] = 0.0224071133828497;
			gauss[2][0] = 0.951577951807409; gauss[2][1] = 0.0345222713688205;
			gauss[3][0] = 0.911357328268571; gauss[3][1] = 0.045745010811225;
			gauss[4][0] = 0.860483088667615; gauss[4][1] = 0.055783322773667;
			gauss[5][0] = 0.800272652330841; gauss[5][1] = 0.0643769812696681;
			gauss[6][0] = 0.73228537068798; gauss[6][1] = 0.0713033510868033;
			gauss[7][0] = 0.658282049981815; gauss[7][1] = 0.0763830210329298;
			gauss[8][0] = 0.580179322820113; gauss[8][1] = 0.0794844216969772;
			gauss[9][0] = 0.5; gauss[9][1] = 0.0805272249243918;
			gauss[10][0] = 0.419820677179887; gauss[10][1] = 0.0794844216969772;
			gauss[11][0] = 0.341717950018185; gauss[11][1] = 0.0763830210329298;
			gauss[12][0] = 0.26771462931202; gauss[12][1] = 0.0713033510868033;
			gauss[13][0] = 0.19972734766916; gauss[13][1] = 0.0643769812696681;
			gauss[14][0] = 0.139516911332385; gauss[14][1] = 0.055783322773667;
			gauss[15][0] = 0.0886426717314286; gauss[15][1] = 0.045745010811225;
			gauss[16][0] = 0.048422048192591; gauss[16][1] = 0.0345222713688205;
			gauss[17][0] = 0.019895923932585; gauss[17][1] = 0.0224071133828497;
			gauss[18][0] = 0.00379657807820782; gauss[18][1] = 0.00973089411486321;
			break;
		case 20:  // 20-point Gauss rule
			gauss[0][0] = 0.996564299592547; gauss[0][1] = 0.00880700356957584;
			gauss[1][0] = 0.981985963638957; gauss[1][1] = 0.0203007149001935;
			gauss[2][0] = 0.956117214125663; gauss[2][1] = 0.0313360241670545;
			gauss[3][0] = 0.919558485911109; gauss[3][1] = 0.0416383707883524;
			gauss[4][0] = 0.873165953230075; gauss[4][1] = 0.0509650599086202;
			gauss[5][0] = 0.818026840363258; gauss[5][1] = 0.0590972659807592;
			gauss[6][0] = 0.755433500975414; gauss[6][1] = 0.0658443192245883;
			gauss[7][0] = 0.68685304435771; gauss[7][1] = 0.0710480546591911;
			gauss[8][0] = 0.613892925570823; gauss[8][1] = 0.0745864932363019;
			gauss[9][0] = 0.538263260566749; gauss[9][1] = 0.076376693565363;
			gauss[10][0] = 0.461736739433251; gauss[10][1] = 0.076376693565363;
			gauss[11][0] = 0.386107074429177; gauss[11][1] = 0.0745864932363019;
			gauss[12][0] = 0.31314695564229; gauss[12][1] = 0.0710480546591911;
			gauss[13][0] = 0.244566499024586; gauss[13][1] = 0.0658443192245883;
			gauss[14][0] = 0.181973159636742; gauss[14][1] = 0.0590972659807592;
			gauss[15][0] = 0.126834046769925; gauss[15][1] = 0.0509650599086202;
			gauss[16][0] = 0.0804415140888906; gauss[16][1] = 0.0416383707883524;
			gauss[17][0] = 0.043882785874337; gauss[17][1] = 0.0313360241670545;
			gauss[18][0] = 0.0180140363610431; gauss[18][1] = 0.0203007149001935;
			gauss[19][0] = 0.00343570040745256; gauss[19][1] = 0.00880700356957584;
			break;
		default:
			printf("%d-point Lagrange rule is not supported.\n",num_qp);
			break;
	}
	
	return;
}

/**
 * \fn void init_NewtonCotes1D(int num_qp, int ncoor, double (*newtoncotes)[2])
 * \brief Initialize closed Newton-Cotes quadrature points and weights, the algebraic precision is num_qp-1
 * \param num_qp the number of quadrature points
 * \param ncoor the dimension of space
 * \param (*newtoncotes)[2] newtoncotes[*][0] -- quad point x in ref coor
 *							newtoncotes[*][1] -- quad weight
 */
void init_NewtonCotes1D(int num_qp, int ncoor, double (*newtoncotes)[2])
{
	if(num_qp<=0)
	{
		printf(" Number of quadrature points must be positive.\n");
		return;
	}
	
	if(ncoor!=1)
	{
		printf(" Only 1-d quadrature rule supported currently.\n");
		return;
	}
	
	switch (num_qp) {
		case 2:  // 2-point Gauss rule
			newtoncotes[0][0] = 0.0;
			newtoncotes[0][1] = 0.5;
			
			newtoncotes[1][0] = 1.0;
			newtoncotes[1][1] = 0.5;
			break;
		case 3:  // 3-point Gauss rule
			newtoncotes[0][0] = 0.0;
			newtoncotes[0][1] = 1.0/6.0;
			
			newtoncotes[1][0] = 0.5;
			newtoncotes[1][1] = 2.0/3.0;
			
			newtoncotes[2][0] = 1.0;
			newtoncotes[2][1] = 1.0/6.0;
			break;
		case 4:  // 4-point Gauss rule
			newtoncotes[0][0] = 0.0;
			newtoncotes[0][1] = 1.0/8.0;
			
			newtoncotes[1][0] = 1.0/3.0;
			newtoncotes[1][1] = 3.0/8.0;
			
			newtoncotes[2][0] = 2.0/3.0;
			newtoncotes[2][1] = 3.0/8.0;
			
			newtoncotes[3][0] = 1.0;
			newtoncotes[3][1] = 1.0/8.0;
			break;
		case 5:  // 5-point Gauss rule
			newtoncotes[0][0] = 0.0;
			newtoncotes[0][1] = 7.0/90.0;
			
			newtoncotes[1][0] = 1.0/4.0;
			newtoncotes[1][1] = 32.0/90.0;
			
			newtoncotes[2][0] = 1.0/2.0;
			newtoncotes[2][1] = 12.0/90.0;
			
			newtoncotes[3][0] = 3.0/4.0;
			newtoncotes[3][1] = 32.0/90.0;
			
			newtoncotes[4][0] = 1.0;
			newtoncotes[4][1] = 7.0/90.0;
			break;
		default:
			printf("%d-point Newton-Cotes rule is not supported.\n",num_qp);
			break;
	}
	
	return;
}